---
title: bash
tags: shell,man1
---


------

***<font color=blue>版权声明：</font>本文翻译自<font color=blue>《bash manpages》。</font>bash的版本为5.0.17，手册更新时间为2018-12-7。<font color=red>本文与原文档采用相同的版权许可。</font><font color=blue>转载请注明出处！！！</font>***

------

# 名称
bash--GNU Bourne-Again Shell

# 总览
**bash** \[选项] \[命令字符串 | 文件]
# 版权
Bash 版权©1989-2018 由自由软件基金会公司所有。

# 描述
**Bash**是一个**sh**兼容的命令语言解释器，它执行从标准输入或文件中读取的命令。 **Bash** 还引入了来自 Korn shell和C shell（即ksh 和 csh）的一些有用特性。

**Bash**旨在成为IEEE POSIX规范（IEEE 标准 1003.1）中的《Shell和实用工具》部分的一致实现。 默认情况下，**Bash**配置为符合 POSIX 标准。

|短选项|描述|
|:--|:--|
|**-c**|如果存在 **-c** 选项，则从第一个非选项参数<u>命令字符串</u>中读取命令。 如果在<u>命令字符串</u>之后有参数，则将第一个参数分配给 **\$0**，并将剩余参数分配给位置参数。 对 **\$0** 的赋值设置了 shell 的名称以用于警告和错误消息。|
|**-i**|如果存在 **-i** 选项，则shell是交互式的。|
|**-l**|使**bash**行为像作为<u>登录shell</u>被调用一样（参见下面的 [**调用**](#INVOCATION)）。|
|**-r**|如果存在 **-r** 选项，shell将成为<u>受限的</u>（请参阅下面的 [**受限的SHELL**](#RESTRICTEDSHELL)）。|
|**-s**|如果存在 **-s** 选项，或者在选项处理后没有留下任何参数，则从标准输入读取命令。此选项允许在调用<u>交互式shell</u>或通过管道读取输入时设置位置参数。|
|**-v**|在读取 shell 输入行时打印它们。|
|**-x**|在执行时打印命令及其参数。|
|**-D**| 以 **\$** 开头的所有双引号字符串组成的列表将被打印在标准输出上。这些是当前本地环境不是 **C** 或 **POSIX** 时需要进行语言翻译的字符串。这隐含着 **-n** 选项；且不会执行任何命令。|
|**\[-+]O \[** <u>shopt选项</u> **\]** | <u>shopt选项</u> 是被内置命令**shopt**接受的shell选项之一（参见下面的 [**SHELL内建命令**](#SHELLBUILTINCOMMANDS)）。如果存在<u>shopt选项</u>，则 **-O**设置该选项的值； **+O**取消设置。如果未提供<u>shopt选项</u>，则**shopt** 接受的shell选项的名称和值将打印在标准输出中。如果调用选项为 **+O**，则输出以可重复用作输入的格式显示。|
|**--**|一个 -- 表示选项结束并禁用后续的选项处理。-- 之后的任何参数都被视为文件名和参数。 - 的一个参数等价于 -- (*译者注：这句话不太明白其意思*)。|
|&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;||

**Bash** 也可以解析多字符选项。 这些选项必须出现在要识别的单字符选项之前的命令行中。

|长选项|描述|
|:--|:--|
|**--debugger**|准备在shell启动之前要执行的调试器配置文件。 打开扩展调试模式（参见下面 **shopt** 内置的 [**extdebug**](#EXTDEBUG) 选项的描述）。|
|**--dump-po-strings**|等效于 **-D**，但输出为 GNU <u>gettext</u> **po**（可移植对象）文件格式。|
|**--dump-strings**|等效于 **-D**。|
|**--help**|在标准输出上显示用法并成功退出。|
|**--init-file** <u>文件</u><br />**--rcfile** <u>文件</u>|如果shell是交互式的，则从<u>文件</u> 而不是系统范围的初始化文件 `/etc/bash.bashrc` 和标准的个人初始化文件 `~/.bashrc` 执行命令（参见下面的 [**调用**](#INVOCATION)）。）。
|**--login**|相当于 **-l**。|
|**--noediting**|当shell是交互式的时，不要使用 GNU <u>readline</u> 库来读取命令行。|
|**--noprofile**|不要读取系统范围的启动文件`/etc/profile`或任何个人初始化文件`~/.bash_profile`、`~/.bash_login`或`~/.profile`。默认情况下，**bash** 在作为 <u>登录shell</u> 调用时会读取这些文件（参见下面的 [**调用**](#INVOCATION)）。）。
|**--norc** |如果shell是交互式的，则不要读取和执行系统范围的初始化文件 `/etc/bash.bashrc` 和个人初始化文件`~/.bashrc`。如果shell作为**sh**调用，则默认情况下此选项处于启用状态。|
|**--posix**|改变默认操作与POSIX标准不同的**bash**行为以匹配标准（<u>posix 模式</u>）。有关详细说明<u>posix 模式</u>如何影响**bash**行为的文档，请参见下面的[**另见**](#SEEALSO)。
|**--restricted**|shell 将成为<u>受限的</u>（请参阅下面的[**受限的SHELL**](#RESTRICTEDSHELL)）。|
|**--verbose**|等效于 **-v**。|
|**--version**|在标准输出上显示此 bash 实例的版本信息并成功退出。|
|&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;||

# 参数

如果在选项处理之后参数仍然存在，并且既没有提供 **-c** 也没有提供 **-s** 选项，则假定第一个参数是包含shell命令的文件的名称。 如果以这种方式调用**bash**，则将 **\$0** 设置为文件名，并将位置参数设置为其余参数。 **Bash** 从这个文件中读取并执行命令，然后退出。 **Bash** 的退出状态是脚本中执行的最后一个命令的退出状态。 如果没有执行任何命令，则退出状态为0。首先尝试打开当前目录中的文件，如果没有找到文件，则shell在**PATH**中的目录中搜索脚本。

# 调用

<span id="INVOCATION"><u>登录shell</u></span>是参数零的第一个字符是 - 或以 **--login** 选项开头的shell。

<u>交互式shell</u>是这样一种shell：启动时不带非选项参数（除非指定 **-s**）且不带 **-c** 选项，其标准输入和错误都连接到终端（由 <u>isatty</u>(3) 确定）；或者以 **-i** 选项启动。 如果**bash**是交互式的，则会设置**PS1**并且 **$-** 包括 **i** ，允许shell脚本或启动文件测试此状态。

以下段落描述了**bash**如何执行其启动文件。如果文件存在但无法读取，**bash**会报告错误。波浪号会按照下文[**展开**](#EXPANSION)章节中的[**波浪号展开**](#TildeExpansion)所述在文件名中展开。

当**bash**作为<u>交互式登录shell</u>或作为带有 **--login** 选项的<u>非交互式shell</u>调用时，它首先从文件`/etc/profile`中读取并执行命令（如果该文件存在）。读取该文件后，它会按顺序查找`~/.bash_profile`、`~/.bash_login`和`~/.profile`，然后从第一个存在且可读的文件中读取并执行命令。当shell启动时，可以使用 **--noprofile** 选项来禁止这种行为。

当<u>交互式登录shell</u>退出或<u>非交互式登录shell</u>执行内置命令**exit**时，**bash**会从文件 `~/.bash_logout`（如果存在）读取并执行命令。

当一个<u>非登录交互式shell</u>启动时，**bash**会从`/etc/bash.bashrc`和`~/.bashrc`（如果这些文件存在）读取并执行命令。这可以通过使用 `--norc` 选项来禁止。 选项 **--rcfile** <u>文件</u> 将强制**bash**从<u>文件</u>而不是 `/etc/bash.bashrc`和`~/.bashrc`读取和执行命令。

当**bash**以非交互方式启动时（例如运行一个shell脚本），它会在环境中查找变量**BASH_ENV**，如果它出现则展开它的值，并将展开值用作要读取和执行的文件名. **Bash** 的行为就像执行了以下命令：
&emsp;&emsp;`if [ -n "$BASH_ENV" ]; then . "$BASH_ENV"; fi`
但**PATH**变量的值不用于搜索文件名。

如果用名称**sh**调用**bash**，它会尝试尽可能地模仿**sh**的历史版本的启动行为，同时也遵守POSIX标准。当作为<u>交互式登录shell</u>或带有 **--login** 选项的<u>非交互式shell</u>调用时，它首先尝试按顺序从`/etc/profile`和`~/.profile`读取和执行命令。 **--noprofile** 选项可用于禁止此行为。当用名称**sh**调用**bash**作为的交互式shell时，**bash**查找变量**ENV**，如果已定义则展开其值，并使用展开的值作为要读取和执行的文件的名称。由于作为 **sh** 调用的 shell 不会尝试从任何其他启动文件读取和执行命令，因此 **--rcfile** 选项无效。使用名称sh调用的非交互式shell 不会尝试读取任何其他启动文件。当作为**sh**调用时，**bash**在读取启动文件后进入<u>posix 模式</u>。

当**bash**在<u>posix模式</u>下启动时，就像使用了 **--posix** 命令行选项一样，它遵循用于启动文件的POSIX标准。在这种模式下，<u>交互式shell</u>展开**ENV**变量，并从名称为展开值的文件中读取和执行命令。不会读取其他启动文件。

**bash**试图确定它何时运行在其标准输入连接到网络的情况下，就像由远程shell守护程序（通常是 <u>rshd</u>）或安全shell守护程序 <u>sshd</u>执行时一样。如果 **bash** 确定它正在以这种方式运行，它会从 `~/.bashrc`和 `~/.bashrc` 读取并执行命令，前提是这些文件存在并且可读。如果作为**sh**调用，它将不会执行此操作。 **--norc** 选项可用于禁止此行为，**--rcfile** 选项可用于强制读取另一个文件，但<u>rshd</u>和<u>sshd</u>通常都不会使用这些选项调用shell或允许指定它们。

如果以不等于实际用户（组）id 的有效用户（组）id 启动shell，并且未提供 **-p** 选项，则不读取启动文件，不从环境继承shell函数，如果环境中出现**SHELLOPTS** 、**BASHOPTS**、**CDPATH** 和 **GLOBIGNORE** 变量将被忽略，有效用户id被设置为实际用户id。如果在调用时提供了 **-p** 选项，则启动行为是相同的，但不会重置有效用户ID。

# 定义

以下定义在本文档的其余部分中使用。

|术语|描述|
|:--|:--|
|**空白**| 一个空格或制表符。|
|**字**| 被shell视为一个单元的字符序列。 也称为**标记**。|
|**名称**|仅由字母数字和下划线组成并以字母或下划线开头的词。 也称为**标识符**。|
|**元字符**| 在没有加引号时，用来分隔单词的字符。 以下之一：<br />&emsp;&emsp; **`| & ; ( ) < > 空格 制表符 新行符`**|
|**控制运算符**| 执行控制功能的**标记**。 它是以下符号之一：<br />&emsp;&emsp; **`|| & && ; ;; ;& ;;& ( ) | |& 新行符`**|

# 保留字

<u>保留字</u> 是对 shell 具有特殊含义的字。 以下字在未加引号时被识别为保留字，并且是简单命令的第一个字（见下面的[**shell语法**](#SHELLGRAMMAR)）或者是命令 **case**或**for**的第三个字：
&emsp;&emsp;**`！ case coproc do done elif else esac fi for function if in select then until while { } time [[ ]]`**

# shell语法

## 简单命令

<span id="SHELLGRAMMAR"><u>简单命令</u></span>就是变量赋值的一个序列（可选的），后跟空格分隔的字和重定向，并由<u>控制运算符</u>终止。 第一个字指定要执行的命令，并作为参数零传递。 剩余的字作为参数传递给调用的命令。

<u>简单命令</u>的返回值是它的退出状态，如果命令被信号 <u>n</u> 终止，则返回 128+<u>n</u>。

## 管道

管道是由控制运算符 **`|`** 或 **`|&`** 分隔的一个或多个命令的一个序列 。管道的格式是：
&emsp;&emsp;[**time** [ **-p** ]] [ ! ] command [ [ **|** | **|&** ] command2 ... ]
<u>command</u> 的标准输出通过管道连接到 <u>command2</u> 的标准输入。此连接在由命令指定的任何重定向之前执行（请参阅下面的[**重定向**](#REDIRECTION)）。如果使用了 **`|&`**，则除了<u>command</u>的标准输出以外，它的标准错误也会通过管道连接到<u>command2</u>的标准输入；它是 **`2>&1 |`** 的简写。标准错误到标准输出的这种隐式重定向是在由命令指定的任何重定向之后执行的。

除非启用了**pipefail**选项, 否则管道的返回状态是最后一个命令的退出状态。如果启用了**pipefail**，则管道的返回状态是最后一个（最右边）以非零状态退出的命令的值，如果所有命令都成功退出则返回零。如果保留字 **`!`** 在管道之前，该管道的退出状态是上述退出状态的逻辑否定。 shell在返回值之前等待管道中的所有命令终止。

如果保留字**time**在管道之前，则在管道终止时报告其执行所消耗的真实时间以及用户和系统时间。 **-p** 选项将输出格式更改为POSIX指定的格式。当shell处于 <u>posix 模式</u>时，如果下一个标记以 **-** 开头，它不会将**time**识别为保留字。 **TIMEFORMAT** 变量可以设置为格式字符串，用于指定计时信息的显示方式；请参阅下面的 [**Shell变量**](#ShellVariables)中对 **TIMEFORMAT** 的描述。

当 shell 处于 <u>posix 模式</u>时，**time**后面可以跟一个新行符。在这种情况下，shell会显示shell及其子进程消耗的总用户和系统时间。**TIMEFORMAT**变量可用于指定时间信息的格式。

管道中的每个命令都作为单独的进程执行（即在subshell中）。有关subshell环境的描述，请参阅[**命令执行环境**](#COMMANDEXECUTIONENVIRONMENT)。如果使用内置**shopt**启用了**lastpipe**选项（请参阅下面对[**shopt**](#shopt)的描述），则管道的最后一个元素可以由 shell进程运行。

## 命令列表

<u>命令列表</u>是一个或多个管道的序列，这个序列由运算符 **`;`**、**`&`**、**`&&`** 或 **`||`** 之一分隔，且由 **`;`**、**`&`** 或 **`新行符`** 之一终止（可选的）。

在这些<u>命令列表</u>运算符中，**`&&`** 和 **`||`** 具有相同的优先级，其次是 **`;`** 和 **`&`**，它们具有相同的优先级。

一个或多个新行符的序列可能会出现在<u>命令列表</u>中，而不是用分号来分隔命令。

如果命令由控制运算符 **`&`** 终止，则shell在subshell的后台执行命令。 shell不等待命令完成，返回状态为0。这些称为<u>异步</u>命令。用 **`;`** 分隔的命令依次执行； shell等待每个命令依次终止。返回状态是最后执行的命令的退出状态。

AND和OR列表是由控制运算符 **`&&`** 和 **`||`** 分别分隔的一个或多个管道的序列。 AND和OR列表以左结合性执行。 

AND列表具有以下形式

&emsp;&emsp;·<u>command1</u> **&&** <u>command2</u>

当且仅当 <u>command1</u> 返回退出状态为零（成功）时，才会执行 <u>command2</u>。

OR列表具有以下形式

&emsp;&emsp;·<u>command1</u> **||** <u>command2</u>

当且仅当 <u>command1</u> 返回非零退出状态时，才会执行 <u>command2</u>。 AND 和 OR 列表的返回状态是列表中执行的最后一个命令的退出状态。



## 复合命令

<u>复合命令</u>是以下之一。 在大多数情况下，命令描述中的<u>命令列表</u>可以用一个或多个换行符与<u>命令列表</u>的其余部分分开，并且可以后跟换行符来代替分号。
|符合命令|描述|
|:--|:--|
|**(<u>命令列表</u>)**|
|**{ <u>命令列表</u>; }**|
|**((<u>表达式</u>))**|根据下面[**算术评估**](#ARITHMETICEVALUATIO)中描述的规则计算<u>表达式</u>的值。 如果<u>表达式</u>的值为非零，则返回状态为0； 否则返回状态为 1。这完全等价于 **let "**<u>表达式</u>**"**。|
|**\[\[ <u>表达式</u>]]**|



------

***<font color=blue>版权声明：</font>本文翻译自<font color=blue>《bash manpages》。</font>bash的版本为5.0.17，手册更新时间为2018-12-7。<font color=red>本文与原文档采用相同的版权许可。</font><font color=blue>转载请注明出处！！！</font>***

------